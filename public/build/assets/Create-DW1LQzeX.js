import{j as e,R as T,r as f,b as R,a as _}from"./app-DmjyuezX.js";import{A as D}from"./AuthenticatedLayout-B8NwpjC1.js";import{S as d,A as W,l as L}from"./ActionBar-BDMrh856.js";import{C as U,d as q}from"./Delete-BeeBUaRl.js";import"./TextInput-BFJj8-ks.js";import{B as h}from"./Box-DGleZsfy.js";import{T as u}from"./TextField-D6JJxO1H.js";import{T as m,I as z}from"./Typography-B3gijyeL.js";import{C as H}from"./CustomSelectCategoryBox-D-SdN0yF.js";import"./ApplicationLogo-BK6yXZps.js";import"./transition-Dgna_if1.js";import"./Autocomplete-C9czNi1d.js";function O({index:n,handleFileChange:j,handleCheckboxChange:w,handleRemoveFileInput:b,selectedFile:r,type:C}){let v=!0;try{v=r.src&&!1}catch{}return e.jsxs(U,{className:"mb-4",sx:{width:"300px",height:"300px",margin:"20px",position:"relative",overflow:"hidden"},children:[e.jsx(h,{sx:{position:"absolute",top:"10px",left:"10px"},children:e.jsxs(d,{sx:{backgroundColor:"rgba(0,0,0,0.6)",color:"#ddd",padding:"5px 10px",margin:"5px",borderRadius:"5px"},children:[r.src&&e.jsxs(h,{children:[e.jsx("input",{type:"checkbox",id:`isFrame-${n}`,checked:r.isFrame,onChange:c=>w(n,c,"frame")}),e.jsx("label",{htmlFor:`isFrame-${n}`,className:"ml-2",children:"Frame"})]}),e.jsxs(h,{children:[e.jsx("input",{type:"checkbox",id:`isText-${n}`,checked:r.isText,onChange:c=>w(n,c,"text")}),e.jsx("label",{htmlFor:`isText-${n}`,className:"ml-2",children:"Text"})]})]})}),!r.isText&&e.jsx(h,{sx:{position:"absolute",bottom:"0px",left:"0px",width:"100%",backgroundColor:"lightblue"},children:e.jsx("input",{type:"file",onChange:c=>j(n,c,!1)})}),r.src==null&&e.jsx(h,{sx:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:r.isText?e.jsx(u,{id:"outlined-basic",label:"Enter text here",variant:"outlined",onChange:c=>j(n,c,!0)}):e.jsx(m,{variant:"h5",component:"h2",color:"#444",children:"Select "+C})}),!r.isText&&e.jsx("div",{className:"mt-2",children:r.src&&e.jsx(h,{sx:{width:"100%",height:"100%"},children:e.jsx("img",{src:r.src,alt:`Selected file ${n}`,style:{width:"100%",height:"100%",objectFit:"cover"}})})}),e.jsx(h,{sx:{position:"absolute",top:"10px",right:"10px"},children:e.jsx(z,{onClick:()=>b(n),"aria-label":"delete",children:e.jsx(q,{color:"warning"})})})]},n)}function ae({auth:n,type:j,title:w,headerOptions:b,categories:r,apiToken:C}){const[v,c]=T.useState({name:"",id:""}),k=(t,i)=>{i&&c({name:i.name,id:i.id})};T.useEffect(()=>{localStorage.setItem("apiToken",C)},[]);const[y,F]=f.useState([]),[l,x]=f.useState([]),[p,S]=f.useState({title:"",tags:"",height:"",width:""}),g=(t,i)=>{S(s=>({...s,[t]:i}))},I=(t,i,s=!1)=>{if(s){const a=[...l],o=a[t];o.src=null,o.image=null,o.text=i.target.value,a[t]=o,x(a)}else{const a=i.target.files[0];if(a){const o=[...l];o[t]={id:a.name,src:URL.createObjectURL(a),x:0,y:0,rotation:0,image:a,isFrame:!1,isText:!1,text:!1},x(o)}}},$=(t,i,s)=>{const a=[...l];s=="text"?a[t]&&(a[t]={id:l.length+1,src:null,x:0,y:0,rotation:0,image:null,isFrame:!1,isText:i.target.checked,text:null},x(a)):s=="frame"&&a[t]&&(a[t].isFrame=i.target.checked,x(a))},E=t=>{const i=l.filter((a,o)=>o!==t),s=y.filter((a,o)=>o!==t);x(i),F(s)},A=()=>{x([...l,{id:l.length+1,src:null,x:0,y:0,rotation:0,image:null,isFrame:!1,isText:!1,text:null}])},B=f.useCallback(()=>{const t=new FormData;l.forEach((s,a)=>{console.log(s),t.append(`items[${a}][id]`,s.id),t.append(`items[${a}][x]`,s.x),t.append(`items[${a}][y]`,s.y),t.append(`items[${a}][rotation]`,s.rotation),t.append(`items[${a}][isFrame]`,s.isFrame?"1":"0"),t.append(`items[${a}][isText]`,s.isText?"1":"0"),s.isText?t.append(`items[${a}][text]`,s.text):(t.append(`items[${a}][src]`,s.src),t.append(`items[${a}][image]`,s.image))}),t.append("user_id",n.user.id),t.append("title",p.title),t.append("tags",p.tags),t.append("height",p.height),t.append("width",p.width),t.append("source","panel"),t.append("category_id",v.id);const i=localStorage.getItem("apiToken");R.post(route("save.template"),t,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${i}`}}).then(s=>{window.location.href=route("view.all.templates")}).catch(s=>{})},[y]),N={Create:function(){B()},"Add Image":function(){A()}};return e.jsxs(D,{user:n.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Create Template"}),actionBar:e.jsxs(W,{actions:N,headerOptions:b,children:[e.jsx(H,{categories:r,changeCategory:k}),e.jsx(L,{onClick:()=>{console.log(l)},children:"Check"})]}),children:[e.jsx(_,{title:"Dashboard"}),e.jsx("div",{className:"square-pattern-bg",children:e.jsx("div",{className:"py-12",style:{width:"100%"},children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",style:{position:"relative",width:"100%"},children:[e.jsxs(d,{spacing:5,direction:"row",justifyContent:"center",sx:{padding:"30px 0px",backgroundColor:"white",width:"100%"},children:[e.jsxs(d,{spacing:1,children:[e.jsx(m,{variant:"p",component:"p",children:"Enter title for template"}),e.jsx(u,{onChange:t=>{g("title",t.target.value)},value:p.title,sx:{width:"200px"},id:"outlined-basic",label:"Title",variant:"outlined"})]}),e.jsxs(d,{spacing:1,children:[e.jsx(m,{variant:"p",component:"p",children:"Enter tags for template"}),e.jsx(u,{onChange:t=>{g("tags",t.target.value)},value:p.tags,sx:{width:"200px"},id:"outlined-basic",label:"Tags",variant:"outlined"})]}),e.jsxs(d,{spacing:1,children:[e.jsx(m,{variant:"p",component:"p",children:"Enter width for template"}),e.jsx(u,{onChange:t=>{g("width",t.target.value)},value:p.width,sx:{width:"200px"},id:"outlined-basic",label:"Width",variant:"outlined"})]}),e.jsxs(d,{spacing:1,children:[e.jsx(m,{variant:"p",component:"p",children:"Enter height for template"}),e.jsx(u,{onChange:t=>{g("height",t.target.value)},value:p.height,sx:{width:"200px"},id:"outlined-basic",label:"Height",variant:"outlined"})]})]}),l.length==0&&e.jsx(h,{sx:{width:"100%",height:"30vh",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(m,{variant:"h5",component:"h2",color:"#444",children:'Click "Add Image" button to add files'})}),e.jsx(d,{direction:"row",flexWrap:"wrap",justifyContent:"center",children:l.map((t,i)=>e.jsx(O,{index:i,handleFileChange:I,handleRemoveFileInput:E,handleCheckboxChange:$,selectedFile:l[i],type:i>1?"image":i==0?"thumbnail":"shade"},i))})]})})})]})}export{ae as default};
