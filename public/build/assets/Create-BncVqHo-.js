import{j as e,R as $,r as u,b as A,a as E}from"./app-VwVb2SUy.js";import{A as N}from"./AuthenticatedLayout-D_TfFiWh.js";import{A as B,S as h,T as g}from"./ActionBar-BZo1p2Wl.js";import{C as R,d as _}from"./Delete-BxYX6PNo.js";import{B as d}from"./Box-lMdwqh2V.js";import{T as m,I as D}from"./Typography-Dync4jcg.js";import"./ApplicationLogo-BPjQgJLl.js";import"./transition-CdZRRXWO.js";function W({index:n,handleFileChange:w,handleCheckboxChange:b,handleRemoveFileInput:f,selectedFile:c,type:l}){let p=!0;try{p=c.src&&!1}catch{}return e.jsxs(R,{className:"mb-4",sx:{width:"300px",height:"300px",margin:"20px",position:"relative",overflow:"hidden"},children:[e.jsx(d,{sx:{position:"absolute",bottom:"0px",left:"0px",width:"100%",backgroundColor:"lightblue"},children:e.jsx("input",{type:"file",onChange:r=>w(n,r)})}),p&&e.jsx(d,{sx:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(m,{variant:"h5",component:"h2",color:"#444",children:l=="thumb"?"Select thumbnail":"Select file"})}),c&&e.jsxs("div",{className:"mt-2",children:[c.src&&e.jsx(d,{sx:{width:"100%",height:"100%"},children:e.jsx("img",{src:c.src,alt:`Selected file ${n}`,style:{width:"100%",height:"100%",objectFit:"cover"}})}),e.jsxs(d,{sx:{position:"absolute",top:"10px",left:"10px"},children:[e.jsx("input",{type:"checkbox",id:`isFrame-${n}`,checked:c.isFrame,onChange:r=>b(n,r)}),e.jsx("label",{htmlFor:`isFrame-${n}`,className:"ml-2",children:"Frame"})]})]}),e.jsx(d,{sx:{position:"absolute",top:"10px",right:"10px"},children:e.jsx(D,{onClick:()=>f(n),"aria-label":"delete",children:e.jsx(_,{color:"warning"})})})]},n)}function J({auth:n,type:w,title:b,headerOptions:f,apiToken:c}){$.useEffect(()=>{localStorage.setItem("apiToken",c)},[]);const[l,p]=u.useState([]),[r,v]=u.useState([]),[o,C]=u.useState({title:"",tags:"",height:"",width:""}),x=(t,s)=>{C(a=>({...a,[t]:s}))},y=(t,s)=>{const a=s.target.files[0];if(a){const i=[...l];i[t]={id:a.name,src:URL.createObjectURL(a),x:0,y:0,rotation:0,image:a,isFrame:!1},p(i)}},F=(t,s)=>{const a=[...l];a[t]&&(a[t].isFrame=s.target.checked,p(a))},I=t=>{const s=r.filter((i,j)=>j!==t),a=l.filter((i,j)=>j!==t);v(s),p(a)},S=()=>{v([...r,r.length])},k=u.useCallback(()=>{const t=new FormData;l.forEach((a,i)=>{t.append(`items[${i}][id]`,a.id),t.append(`items[${i}][src]`,a.src),t.append(`items[${i}][x]`,a.x),t.append(`items[${i}][y]`,a.y),t.append(`items[${i}][rotation]`,a.rotation),t.append(`items[${i}][image]`,a.image),t.append(`items[${i}][isFrame]`,a.isFrame?"1":"0")}),t.append("user_id",n.user.id),t.append("title",o.title),t.append("tags",o.tags),t.append("height",o.height),t.append("width",o.width),t.append("source","panel");const s=localStorage.getItem("apiToken");A.post(route("save.template"),t,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${s}`}}).then(a=>{}).catch(a=>{})},[l]),T={Create:function(){k()},"Add Image":function(){S()}};return e.jsxs(N,{user:n.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Create Template"}),actionBar:e.jsx(B,{actions:T,headerOptions:f}),children:[e.jsx(E,{title:"Dashboard"}),e.jsx("div",{className:"square-pattern-bg",children:e.jsx("div",{className:"py-12",style:{width:"100%"},children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",style:{position:"relative",width:"100%"},children:[e.jsxs(h,{spacing:5,direction:"row",justifyContent:"center",sx:{padding:"30px 0px",backgroundColor:"white",width:"100%"},children:[e.jsxs(h,{spacing:1,children:[e.jsx(m,{variant:"p",component:"p",children:"Enter title for template"}),e.jsx(g,{onChange:t=>{x("title",t.target.value)},value:o.title,sx:{width:"200px"},id:"outlined-basic",label:"Title",variant:"outlined"})]}),e.jsxs(h,{spacing:1,children:[e.jsx(m,{variant:"p",component:"p",children:"Enter tags for template"}),e.jsx(g,{onChange:t=>{x("tags",t.target.value)},value:o.tags,sx:{width:"200px"},id:"outlined-basic",label:"Tags",variant:"outlined"})]}),e.jsxs(h,{spacing:1,children:[e.jsx(m,{variant:"p",component:"p",children:"Enter width for template"}),e.jsx(g,{onChange:t=>{x("width",t.target.value)},value:o.width,sx:{width:"200px"},id:"outlined-basic",label:"Width",variant:"outlined"})]}),e.jsxs(h,{spacing:1,children:[e.jsx(m,{variant:"p",component:"p",children:"Enter height for template"}),e.jsx(g,{onChange:t=>{x("height",t.target.value)},value:o.height,sx:{width:"200px"},id:"outlined-basic",label:"Height",variant:"outlined"})]})]}),r.length==0&&e.jsx(d,{sx:{width:"100%",height:"30vh",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(m,{variant:"h5",component:"h2",color:"#444",children:'Click "Add Image" button to add files'})}),e.jsx(h,{direction:"row",flexWrap:"wrap",justifyContent:"center",children:r.map((t,s)=>e.jsx(W,{index:s,handleFileChange:y,handleRemoveFileInput:I,handleCheckboxChange:F,selectedFile:l[s],type:s==0?"thumb":"img"},s))})]})})})]})}export{J as default};
