import{j as e,R as F,r as w,b as _,a as D}from"./app-CwidASn3.js";import{A as W}from"./AuthenticatedLayout-DGUpvdkP.js";import{S as h,A as L}from"./ActionBar-P05cZKee.js";import{C as U,d as q}from"./Delete-TEnnPADU.js";import{B as l}from"./Box-Qck-xHe-.js";import{T as d,I as z}from"./Typography-Cw1heVRv.js";import{T as m}from"./TextField-BJDRxIG5.js";import{C as H}from"./CustomSelectCategoryBox-D692D1-T.js";import"./ApplicationLogo-DxeFdkuR.js";import"./transition-CiTSpC-r.js";import"./Grow-DjfrSq40.js";import"./Autocomplete-D6tL5S-u.js";import"./Close-DO6um72R.js";function O({index:o,handleFileChange:y,handleCheckboxChange:g,handleRemoveFileInput:b,selectedFile:r,type:C,handleTextChange:T}){let u=!0;try{u=r.src&&!1}catch{}return e.jsxs(U,{className:"mb-4",sx:{width:"300px",height:"300px",margin:"20px",position:"relative",overflow:"hidden"},children:[e.jsx(l,{sx:{position:"absolute",bottom:"0px",left:"0px",width:"100%",backgroundColor:"lightblue",opacity:50},children:e.jsx("input",{type:"file",onChange:n=>y(o,n)})}),u&&e.jsx(l,{sx:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(d,{variant:"h5",component:"h2",color:"#444",children:"Select "+C})}),r&&e.jsxs("div",{className:"mt-2",children:[r.src&&e.jsx(l,{sx:{width:"100%",height:"100%"},children:e.jsx("img",{src:r.src,alt:`Selected file ${o}`,style:{width:"100%",height:"100%",objectFit:"cover"}})}),e.jsxs(h,{sx:{position:"absolute",top:"10px",left:"10px",margin:"7px",borderRadius:"12px",padding:"10px 20px ",backgroundColor:"rgba(0,0,0,0.5)",color:"white"},spacing:1,children:[e.jsxs(l,{children:[e.jsx("input",{type:"checkbox",id:`isFrame-${o}`,checked:r.isFrame,onChange:n=>g(o,n,"frame")}),e.jsx("label",{htmlFor:`isFrame-${o}`,className:"ml-2",children:"Frame"})]}),e.jsxs(l,{children:[e.jsx("input",{type:"checkbox",id:`isText-${o}`,checked:r.isText,onChange:n=>g(o,n,"text")}),e.jsx("label",{htmlFor:`isText-${o}`,className:"ml-2",children:"Text"})]}),e.jsxs(l,{children:[e.jsx("input",{type:"checkbox",id:`isTop-${o}`,checked:r.isTop,onChange:n=>g(o,n,"isTop")}),e.jsx("label",{htmlFor:`isTop-${o}`,className:"ml-2",children:"Top"})]})]})]}),e.jsx(l,{sx:{position:"absolute",top:"10px",right:"10px"},children:e.jsx(z,{onClick:()=>b(o),"aria-label":"delete",children:e.jsx(q,{color:"warning"})})}),r&&r.isText&&e.jsx(l,{sx:{position:"absolute",padding:"10px",bottom:"30px",left:"0px",width:"100%",backgroundColor:"white"},children:e.jsx(m,{sx:{width:"100%"},id:"outlined-basic",onChange:n=>{T(o,n)},label:"Enter text here",variant:"outlined"})})]},o)}function se({auth:o,type:y,title:g,headerOptions:b,categories:r,apiToken:C}){const[T,u]=F.useState({name:"",id:""}),n=(t,s)=>{s&&u({name:s.name,id:s.id})};F.useEffect(()=>{localStorage.setItem("apiToken",C)},[]);const[p,f]=w.useState([]),[x,k]=w.useState([]),[c,S]=w.useState({title:"",tags:"",height:"",width:""}),j=(t,s)=>{S(a=>({...a,[t]:s}))},$=(t,s)=>{const a=s.target.files[0];if(a){const i=[...p];i[t]={id:a.name,src:URL.createObjectURL(a),x:0,y:0,rotation:0,image:a,isFrame:!1,isText:!1,isTop:!1,text:!1},f(i)}},I=(t,s)=>{const a=[...p];a[t].text=s.target.value,f(a)},E=(t,s,a)=>{const i=[...p];i[t]&&(a==="frame"&&(i[t].isFrame=s.target.checked),a==="text"&&(i[t].isText=s.target.checked),a==="isTop"&&(i[t].isTop=s.target.checked),f(i))},N=t=>{const s=x.filter((i,v)=>v!==t),a=p.filter((i,v)=>v!==t);k(s),f(a)},A=()=>{k([...x,x.length])},B=w.useCallback(()=>{const t=new FormData;p.forEach((a,i)=>{t.append(`items[${i}][id]`,a.id),t.append(`items[${i}][src]`,a.src),t.append(`items[${i}][x]`,a.x),t.append(`items[${i}][y]`,a.y),t.append(`items[${i}][rotation]`,a.rotation),t.append(`items[${i}][image]`,a.image),t.append(`items[${i}][isFrame]`,a.isFrame?"1":"0"),t.append(`items[${i}][isText]`,a.isText?"1":"0"),t.append(`items[${i}][text]`,a.text),t.append(`items[${i}][isTop]`,a.isTop?"1":"0")}),t.append("user_id",o.user.id),t.append("title",c.title),t.append("tags",c.tags),t.append("height",c.height),t.append("width",c.width),t.append("source","panel"),t.append("category_id",T.id);const s=localStorage.getItem("apiToken");_.post(route("save.template"),t,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${s}`}}).then(a=>{window.location.href=route("view.all.templates")}).catch(a=>{})},[p]),R={Create:function(){B()},"Add Image":function(){A()}};return e.jsxs(W,{user:o.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Create Template"}),actionBar:e.jsx(L,{actions:R,headerOptions:b,children:e.jsx(H,{categories:r,changeCategory:n})}),children:[e.jsx(D,{title:"Dashboard"}),e.jsx("div",{className:"square-pattern-bg",children:e.jsx("div",{className:"py-12",style:{width:"100%"},children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",style:{position:"relative",width:"100%"},children:[e.jsxs(h,{spacing:5,direction:"row",justifyContent:"center",sx:{padding:"30px 0px",backgroundColor:"white",width:"100%"},children:[e.jsxs(h,{spacing:1,children:[e.jsx(d,{variant:"p",component:"p",children:"Enter title for template"}),e.jsx(m,{onChange:t=>{j("title",t.target.value)},value:c.title,sx:{width:"200px"},id:"outlined-basic",label:"Title",variant:"outlined"})]}),e.jsxs(h,{spacing:1,children:[e.jsx(d,{variant:"p",component:"p",children:"Enter tags for template"}),e.jsx(m,{onChange:t=>{j("tags",t.target.value)},value:c.tags,sx:{width:"200px"},id:"outlined-basic",label:"Tags",variant:"outlined"})]}),e.jsxs(h,{spacing:1,children:[e.jsx(d,{variant:"p",component:"p",children:"Enter width for template"}),e.jsx(m,{onChange:t=>{j("width",t.target.value)},value:c.width,sx:{width:"200px"},id:"outlined-basic",label:"Width",variant:"outlined"})]}),e.jsxs(h,{spacing:1,children:[e.jsx(d,{variant:"p",component:"p",children:"Enter height for template"}),e.jsx(m,{onChange:t=>{j("height",t.target.value)},value:c.height,sx:{width:"200px"},id:"outlined-basic",label:"Height",variant:"outlined"})]})]}),x.length==0&&e.jsx(l,{sx:{width:"100%",height:"30vh",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(d,{variant:"h5",component:"h2",color:"#444",children:'Click "Add Image" button to add files'})}),e.jsx(h,{direction:"row",flexWrap:"wrap",justifyContent:"center",children:x.map((t,s)=>e.jsx(O,{index:s,handleFileChange:$,handleRemoveFileInput:N,handleCheckboxChange:E,handleTextChange:I,selectedFile:p[s],type:s>1?"image":s==0?"thumbnail":"shade"},s))})]})})})]})}export{se as default};
