import{j as e,R as k,r as b,b as q,a as D}from"./app-C3mhydF5.js";import{A as W}from"./AuthenticatedLayout-BT9ncWk3.js";import{S as d,A as L}from"./ActionBar-ZN_KoRHG.js";import{C as M,d as O}from"./Delete-CxRS1Xf5.js";import{B as p}from"./Box-DhJ-e75h.js";import{T as m,I as U}from"./Typography-ab3AFR6E.js";import{S as z,T as g}from"./TextField-uqjDUPZP.js";import{M as C}from"./MenuItem-D95IXwgG.js";import{C as H}from"./CustomSelectCategoryBox-9x91FUZh.js";import"./ApplicationLogo-Cd5GwPJR.js";import"./transition-CtBWSXIo.js";import"./Grow-DYBh3_5-.js";import"./Autocomplete-D2lLf6xG.js";import"./Close-Czjnh2UU.js";function P({index:i,handleFileChange:S,handleCheckboxChange:x,handleRemoveFileInput:w,selectedFile:l,type:y,handleTextChange:v}){let f=!0;try{f=l.src&&!1}catch{}return e.jsxs(M,{className:"mb-4",sx:{width:"300px",height:"300px",margin:"20px",position:"relative",overflow:"hidden"},children:[e.jsx(p,{sx:{position:"absolute",bottom:"0px",left:"0px",width:"100%",backgroundColor:"lightblue",opacity:50},children:e.jsx("input",{type:"file",onChange:n=>S(i,n)})}),f&&e.jsx(p,{sx:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(m,{variant:"h5",component:"h2",color:"#444",children:"Select "+y})}),l&&e.jsxs("div",{className:"mt-2",children:[l.src&&e.jsx(p,{sx:{width:"100%",height:"100%"},children:e.jsx("img",{src:l.src,alt:`Selected file ${i}`,style:{width:"100%",height:"100%",objectFit:"cover"}})}),e.jsxs(d,{sx:{position:"absolute",top:"10px",left:"10px",margin:"7px",borderRadius:"12px",width:"200px",padding:"10px 20px ",backgroundColor:"#fff",color:"black"},spacing:1,children:[e.jsxs(p,{children:[e.jsx("input",{type:"checkbox",id:`isFrame-${i}`,checked:l.isFrame,onChange:n=>x(i,n,"frame")}),e.jsx("label",{htmlFor:`isFrame-${i}`,className:"ml-2",children:"Frame"})]}),e.jsxs(p,{children:[e.jsx("input",{type:"checkbox",id:`isText-${i}`,checked:l.isText,onChange:n=>x(i,n,"text")}),e.jsx("label",{htmlFor:`isText-${i}`,className:"ml-2",children:"Text"})]}),e.jsxs(p,{children:[e.jsx("input",{type:"checkbox",id:`isTop-${i}`,checked:l.isTop,onChange:n=>x(i,n,"isTop")}),e.jsx("label",{htmlFor:`isTop-${i}`,className:"ml-2",children:"Top"})]}),l.isFrame&&e.jsxs(z,{value:l.shapeType,label:"Shape Type",id:`shapeType-${i}`,labelId:`shapeType-${i}`,onChange:n=>x(i,n,"shapeType"),children:[e.jsx(C,{value:"circle",children:"Circle"}),e.jsx(C,{value:"square",children:"Square"}),e.jsx(C,{value:"other",children:"Other"})]})]})]}),e.jsx(p,{sx:{position:"absolute",top:"10px",right:"10px"},children:e.jsx(U,{onClick:()=>w(i),"aria-label":"delete",children:e.jsx(O,{color:"warning"})})}),l&&l.isText&&e.jsx(p,{sx:{position:"absolute",padding:"10px",bottom:"30px",left:"0px",width:"100%",backgroundColor:"white"},children:e.jsx(g,{sx:{width:"100%"},id:"outlined-basic",onChange:n=>{v(i,n)},label:"Enter text here",variant:"outlined"})})]},i)}function re({auth:i,type:S,title:x,headerOptions:w,categories:l,apiToken:y}){const[v,f]=k.useState({name:"",id:""}),n=(t,s)=>{s&&f({name:s.name,id:s.id})};k.useEffect(()=>{localStorage.setItem("apiToken",y)},[]);const[h,j]=b.useState([]),[u,$]=b.useState([]),[c,F]=b.useState({title:"",tags:"",height:"",width:""}),T=(t,s)=>{F(o=>({...o,[t]:s}))},I=(t,s)=>{const o=s.target.files[0];if(o){const a=[...h];a[t]={id:o.name,src:URL.createObjectURL(o),x:0,y:0,rotation:0,image:o,isFrame:!1,isText:!1,isTop:!1,text:!1,shapeType:""},j(a)}},E=(t,s)=>{const o=[...h];o[t].text=s.target.value,j(o)},N=(t,s,o)=>{const a=[...h];a[t]&&(o==="frame"&&(a[t].isFrame=s.target.checked),o==="text"&&(a[t].isText=s.target.checked),o==="isTop"&&(a[t].isTop=s.target.checked),o==="shapeType"&&(a[t].shapeType=s.target.value),j(a))},A=t=>{const s=u.filter((a,r)=>r!==t),o=h.filter((a,r)=>r!==t);$(s),j(o)},B=()=>{$([...u,u.length])},R=b.useCallback(()=>{const t=new FormData;let s=0;h.forEach((a,r)=>{a.isFrame&&s++,console.log(a.shapeType),t.append(`items[${r}][id]`,a.id),t.append(`items[${r}][src]`,a.src),t.append(`items[${r}][x]`,a.x),t.append(`items[${r}][y]`,a.y),t.append(`items[${r}][rotation]`,a.rotation),t.append(`items[${r}][image]`,a.image),t.append(`items[${r}][isFrame]`,a.isFrame?"1":"0"),t.append(`items[${r}][isText]`,a.isText?"1":"0"),t.append(`items[${r}][text]`,a.text),t.append(`items[${r}][isTop]`,a.isTop?"1":"0"),t.append(`items[${r}][shapeType]`,a.shapeType||0)}),t.append("user_id",i.user.id),t.append("title",c.title),t.append("tags",c.tags),t.append("height",c.height),t.append("width",c.width),t.append("source","panel"),t.append("frameCount",s),t.append("category_id",v.id);const o=localStorage.getItem("apiToken");q.post(route("save.template"),t,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${o}`}}).then(a=>{window.location.href=route("view.all.templates")}).catch(a=>{})},[h]),_={Create:function(){R()},"Add Image":function(){B()}};return e.jsxs(W,{user:i.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Create Template"}),actionBar:e.jsx(L,{actions:_,headerOptions:w,children:e.jsx(H,{categories:l,changeCategory:n})}),children:[e.jsx(D,{title:"Dashboard"}),e.jsx("div",{className:"square-pattern-bg",children:e.jsx("div",{className:"py-12",style:{width:"100%"},children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",style:{position:"relative",width:"100%"},children:[e.jsxs(d,{spacing:5,direction:"row",justifyContent:"center",sx:{padding:"30px 0px",backgroundColor:"white",width:"100%"},children:[e.jsxs(d,{spacing:1,children:[e.jsx(m,{variant:"p",component:"p",children:"Enter title for template"}),e.jsx(g,{onChange:t=>{T("title",t.target.value)},value:c.title,sx:{width:"200px"},id:"outlined-basic",label:"Title",variant:"outlined"})]}),e.jsxs(d,{spacing:1,children:[e.jsx(m,{variant:"p",component:"p",children:"Enter tags for template"}),e.jsx(g,{onChange:t=>{T("tags",t.target.value)},value:c.tags,sx:{width:"200px"},id:"outlined-basic",label:"Tags",variant:"outlined"})]}),e.jsxs(d,{spacing:1,children:[e.jsx(m,{variant:"p",component:"p",children:"Enter width for template"}),e.jsx(g,{onChange:t=>{T("width",t.target.value)},value:c.width,sx:{width:"200px"},id:"outlined-basic",label:"Width",variant:"outlined"})]}),e.jsxs(d,{spacing:1,children:[e.jsx(m,{variant:"p",component:"p",children:"Enter height for template"}),e.jsx(g,{onChange:t=>{T("height",t.target.value)},value:c.height,sx:{width:"200px"},id:"outlined-basic",label:"Height",variant:"outlined"})]})]}),u.length==0&&e.jsx(p,{sx:{width:"100%",height:"30vh",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(m,{variant:"h5",component:"h2",color:"#444",children:'Click "Add Image" button to add files'})}),e.jsx(d,{direction:"row",flexWrap:"wrap",justifyContent:"center",children:u.map((t,s)=>e.jsx(P,{index:s,handleFileChange:I,handleRemoveFileInput:A,handleCheckboxChange:N,handleTextChange:E,selectedFile:h[s],type:s>1?"image":s==0?"thumbnail":"shade"},s))})]})})})]})}export{re as default};
